# 日历功能说明

## 概述

为 ActivityTracker 应用添加了日历视图功能，可以直观地查看哪些天有完成记录。

## 功能特性

### 1. 日历视图 (`CalendarView.swift`)

- **月份导航**: 左右箭头切换月份
- **完成记录显示**: 有完成记录的日期用彩色圆圈标记
- **日期选择**: 点击日期可以选中，有完成记录的日期会显示详情
- **统计信息**: 显示本月完成次数和当前连续天数
- **图例说明**: 清晰标识不同标记的含义

### 2. 日期详情视图 (`DateDetailView.swift`)

- **完成记录列表**: 显示指定日期的所有完成记录
- **活动信息**: 显示活动名称、类别、图标
- **完成时间**: 显示具体的完成时间
- **完成来源**: 区分应用内完成和小部件完成

### 3. 测试数据生成器 (`TestDataGenerator.swift`)

- **示例活动**: 自动生成冥想、跑步、读书等示例活动
- **随机完成记录**: 在过去 30 天内随机生成完成记录
- **数据管理**: 提供清除所有数据的功能

## 使用方法

### 访问日历

1. 在主界面点击右上角的日历图标
2. 进入日历视图，查看完成记录分布

### 查看日期详情

1. 在日历中点击有完成记录的日期（彩色圆圈）
2. 弹出详情页面，显示该日期的所有完成记录

### 生成测试数据

1. 在主界面点击左上角的"测试数据"按钮
2. 选择"生成"来创建示例数据
3. 选择"清除所有数据"来清空数据

## 技术实现

### 数据模型

- 使用现有的 `Completion` 实体存储完成记录
- 每个完成记录包含 `completedDate`、`source` 等字段

### 核心功能

- **日期计算**: 使用 `Calendar` 进行日期操作和比较
- **数据查询**: 通过 Core Data 查询特定日期的完成记录
- **统计计算**: 实时计算月度完成次数和连续天数

### UI 组件

- **DayCell**: 自定义日期单元格，支持不同状态的显示
- **CompletionRowView**: 完成记录行视图，显示详细信息
- **响应式设计**: 适配不同屏幕尺寸

## 文件结构

```
ActivityTracker/Views/
├── CalendarView.swift          # 主日历视图
├── DateDetailView.swift        # 日期详情视图
└── DashboardView.swift         # 主界面（已更新）

ActivityTracker/Utils/
└── TestDataGenerator.swift     # 测试数据生成器
```

## 设计原则

1. **一致性**: 使用应用的主题色 (`Color.accentColor`)
2. **直观性**: 通过颜色和图标清晰表达信息
3. **响应性**: 支持触摸交互和状态反馈
4. **可访问性**: 提供清晰的图例和说明

## 未来改进

- [ ] 支持按活动筛选日历显示
- [ ] 添加周视图和年视图
- [ ] 支持导出日历数据
- [ ] 添加完成目标的进度显示
- [ ] 支持自定义日历主题
